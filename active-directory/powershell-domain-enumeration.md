# PowerShell Domain Enumeration

**Enumerate All Users**

```powershell
$Searcher = New-Object DirectoryServices.DirectorySearcher
$Searcher.Filter = "(&(objectclass=user))"
$Searcher.SearchRoot = ''
$Searcher.FindAll()
```

**Enumerate All Domain-Joined Machines**

```powershell
$Searcher = New-Object DirectoryServices.DirectorySearcher
$Searcher.Filter = "(&(objectclass=computer))"
$Searcher.SearchRoot = ''
$Searcher.FindAll()
```

**Addendum For Line 2 To Add SPN**

```powershell
$Searcher.Filter = " (&(!(samaccountname=krbtgt))(objectclass=user)(objectcategory=user)(servicePrincipalName=*))"
```

**Enumerate Domain Trusts**

```powershell
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()
```
