# Server Side Template Injection - SSTI

User data concatenated into templates instead of passed as data.

Templates: strings

&#x20;

Detecting:

Fuzz for a potentially valid parameter:

`${{<%[%'"}}%\`

If this brings about an exception it's possible the server is vulnerable.

&#x20;

Contexts:

**Plaintext:**

[`http://vulnerable-website.com/?username=${7*7}`](http://vulnerable-website.com/?username=${7\*7})

&#x20;

Vulnerable result: Hello, 49

&#x20;

The syntax varies by template engine.

&#x20;

**Code:**

Vulnerable code:

greeting = getQueryParameter('greeting')\
engine.render("Hello \{{"+greeting+"\}}", data)

&#x20;

Injection:

[http://vulnerable-website.com/?greeting=data.username](http://vulnerable-website.com/?greeting=data.username)

&#x20;

Vulnerable result: Hello \<name>

&#x20;

To test for this, it may be necessary to test for XSS first as they can look similar.&#x20;

Inject HTML to test:

[http://vulnerable-website.com/?greeting=data.username\<tag>](http://vulnerable-website.com/?greeting=data.username%3Ctag%3E)

If there's an error or a blank “Hello” with no username, test it again to break out of the html:

http://vulnerable-website.com/?greeting=data.username\}}\<tag>

&#x20;

Vulnerable result

Hello Name\<tag>

NB: It's possible if it is returned blank then the wrong syntax was used, so could keep trying.
